<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="jlearning.cn">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="jlearning.cn">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jlearning.cn">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title> jlearning.cn </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">jlearning.cn</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/09/《深入理解java虚拟机》读书笔记（二）——Java内存/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/09/《深入理解java虚拟机》读书笔记（二）——Java内存/" itemprop="url">
                  《深入理解java虚拟机》读书笔记（二）——Java内存
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-09T23:03:10+08:00">
                2017-04-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Java内存"><a href="#Java内存" class="headerlink" title="Java内存"></a>Java内存</h2><p>从观念上介绍Java内存的各个区域，讲解这些区域的作用、服务对象以及其中可能产生的问题。</p>
<h3 id="运行时数据区域"><a href="#运行时数据区域" class="headerlink" title="运行时数据区域"></a>运行时数据区域</h3><p><img src="http://images.cnblogs.com/cnblogs_com/Cratical/201208/201208212311259458.png" alt="运行时数据区"></p>
<h4 id="程序计数器"><a href="#程序计数器" class="headerlink" title="程序计数器"></a>程序计数器</h4><ul>
<li>当前线程所执行的字节码的行号指示器。</li>
<li>每条线程需要一个独立的程序计数器，各条线程之间计数器互不影响，独立存储。所以，这类内存区域为“线程私有”的内存。</li>
<li>此内存区域是唯一一个在Java虚拟机规范中没有规定任何OutOfMemoryError情况的区域。</li>
<li>若执行Java方法，记录正在执行的虚拟机字节码指令的地址。</li>
<li>若执行<strong>Native方法</strong>，计数器值为空（Undefined）。</li>
</ul>
<h4 id="Java虚拟机栈"><a href="#Java虚拟机栈" class="headerlink" title="Java虚拟机栈"></a>Java虚拟机栈</h4><ul>
<li>和程序计数器一样，也是线程私有的，生命周期和线程相同。</li>
<li>虚拟机栈描述的是Java方法执行的内存模型：每个方法在执行的同时都会创建一个栈帧（Stack Frame）用于存储<strong>局部变量表、操作数栈、动态链接、方法出口</strong>等信息。方法的调用到完成——栈帧在虚拟机栈中入栈到出栈。</li>
<li><strong>局部变量表</strong>：存放了编译期可知的各种基本数据类型(64位的long和double占据2个局部变量空间Slot)、对象引用（指向对象起始地址的引用指针，或者指向一个代表对象的句柄，或者其他与此对象相关的位置），和<strong>returnAddress</strong>类型（指向了一条<strong>字节码指令</strong>的地址）</li>
<li>局部变量表所需要的内存在编译期间完成分配，运行期间不会改变局部变量表的大小。</li>
<li>两种异常：<ul>
<li>线程请求栈的深度大于虚拟机允许：StackOverflowError</li>
<li>如果虚拟机栈可以动态扩展，如果扩展式无法申请到足够的内存：OutOfMemoryError</li>
</ul>
</li>
</ul>
<h4 id="本地方法栈"><a href="#本地方法栈" class="headerlink" title="本地方法栈"></a>本地方法栈</h4><ul>
<li>与虚拟机栈类似，虚拟机栈为虚拟机执行Java方法（也就是<strong>字节码</strong>），本地方法栈为执行Native方法服务。</li>
<li><a href="http://blog.csdn.net/wike163/article/details/6635321" target="_blank" rel="external">Native方法</a>：一个Native Method就是一个java调用非java代码的接口。一个Native Method是这样一个java的方法：该方法的实现由非java语言实现，比如C。</li>
</ul>
<h4 id="Java堆"><a href="#Java堆" class="headerlink" title="Java堆"></a>Java堆</h4><ul>
<li>是Java虚拟机所管理的内存中最大的一块，被所有线程共享的一块内存区域，在虚拟机启动时创建。</li>
<li>Java堆的唯一目的：存放对象实例。</li>
<li>随着<strong>JIT编译器</strong>的发展和<strong>逃逸分析技术</strong>逐渐成熟，所有对象都都分配在堆上，已经不那么绝对了。</li>
<li>Java堆是垃圾收集器管理的主要区域，因此也被称作GC堆。（Garbage Collected）</li>
<li>从内存回收的角度，由于基本采用<strong>分代收集算法</strong>：<ul>
<li>Java堆可分为：<ul>
<li>新生代</li>
<li>老年代</li>
</ul>
</li>
<li>更细致一点：<ul>
<li>Eden空间</li>
<li>From Survivor空间</li>
<li>To Survivor空间</li>
</ul>
</li>
</ul>
</li>
<li>从内存分配的角度，可能划分出多个线程私有的分配缓冲区（TLAB）（Tread Local Allocation Buffer）</li>
<li>Java可以处于物理上不连续的内存空间中，只要逻辑上连续的即可。</li>
<li>可以固定大小，也可以扩展（<strong>通过-Xmx和-Xms控制</strong>）</li>
</ul>
<h4 id="方法区"><a href="#方法区" class="headerlink" title="方法区"></a>方法区</h4><ul>
<li>用于存储已被虚拟机加载的<strong>类信息</strong>、<strong>常量</strong>、<strong>静态变量</strong>、<strong>即时编译器编译后的代码</strong>等。</li>
<li>这区域的内存回收目标主要是针对<strong>常量池的回收</strong>和<strong>对类型的卸载</strong>，也可以不实现垃圾收集。</li>
</ul>
<h5 id="运行时的常量池"><a href="#运行时的常量池" class="headerlink" title="运行时的常量池"></a>运行时的常量池</h5><ul>
<li>Class文件中的常量池（Constant Pool Table），用于存放编译期生成的各种<strong>字面量</strong>和<strong>符号引用</strong>。这些内容在类加载后进入方法区的运行时常量池。</li>
<li>除了保存Class文件中描述的<strong>符号引用</strong>外，还会把翻译出来的<strong>直接引用</strong>也存储在运行时常量池。</li>
<li>不一定编译的时候产生常量，运行期间也可能加入新的常量，比如说String.intern()<ul>
<li>intern()：当调用 intern 方法时，如果池已经包含一个等于此 String 对象的字符串（该对象由 equals(Object) 方法确定），则返回池中的字符串。否则，将此 String 对象添加到池中，并且返回此 String 对象的引用。</li>
</ul>
</li>
</ul>
<h4 id="直接内存"><a href="#直接内存" class="headerlink" title="直接内存"></a>直接内存</h4><ul>
<li>JDK1.4新加入NIO类，引入基于<strong>通道(Channel)</strong>与<strong>缓冲区(Buffer)</strong>的I/O方式，可以使用Native函数库直接分配堆外内存，然后通过Java堆中的DirectByteBuffer对象作为对这块内存的引用。避免了再Java堆和Native堆中来回复制数据。</li>
<li>不能忽视直接内存，以免出现OutOfMemoryError异常。</li>
</ul>
<h3 id="HotSpot虚拟机对象探秘"><a href="#HotSpot虚拟机对象探秘" class="headerlink" title="HotSpot虚拟机对象探秘"></a>HotSpot虚拟机对象探秘</h3><h4 id="对象的创建"><a href="#对象的创建" class="headerlink" title="对象的创建"></a>对象的创建</h4><ul>
<li>虚拟机遇到一条new指令，检查这个指令的参数是否能在常量池中定位到一个类的符号引用。并且检查这个符号引用代表的类是否被<strong>加载、解析、初始化过</strong>。如果没有，先执行相应的类加载过程。（可以确定类需要的内存大小）</li>
<li>虚拟机为新生对象分配内存。<ul>
<li>如果Java堆中内存是绝对规整的，把作为分界点指示器的指针，向前挪动一段与对象大小相等的距离。——叫做指针碰撞（Bump the Pointer）。</li>
<li>如果Java堆中内存不是规整的，虚拟机需要维护一个列表，记录那些内存块是可用的。——空闲列表（Free List）。</li>
<li>Java堆是否规整由所采用的垃圾收集器是否带有压缩整理功能决定的。</li>
<li>保证修改指针的线程安全<ol>
<li>采用<strong>CAS</strong>配上<strong>失败重试</strong>的方式保证更新操作的原子性。</li>
<li>另一种方法是把内存分配的动作按照线程划分在不同的空间进行。每个线程在Java堆中预先分配一小块内存，成为本地线程分配缓存（TLAB）</li>
</ol>
</li>
</ul>
</li>
<li>内存分配完成后，虚拟机将分配到的内存空间都初始化为零值（<strong>不包括对象头</strong>）。保证对象的实例字段在Java代码中可以不赋初始值就直接使用。</li>
<li>对对象进行必要的设置<ul>
<li>这个对象是哪个类的实例</li>
<li>如何才能找到类的元数据信息</li>
<li>对象的哈希码</li>
<li>对象的<strong>GC分代年龄</strong></li>
</ul>
</li>
<li>最后执行ini()方法。</li>
</ul>
<h4 id="对象的内存布局"><a href="#对象的内存布局" class="headerlink" title="对象的内存布局"></a>对象的内存布局</h4><ul>
<li>对象头（Header）<ul>
<li>用于存储对象自身的运行时数据。如哈希码，GC分代年龄，锁状态标志，线程持有的锁，偏向想成ID，偏向时间戳等。官方称为Mark Word。</li>
<li>类型指针。即对象指向它的<strong>类元数据</strong>的指针。通过这个指针来确定这个对象是哪个类的实例。</li>
</ul>
</li>
<li>实例数据（Instance Data）<ul>
<li>在程序代码中所定义的各种类型的字段内容。</li>
<li>存储顺序收到虚拟机分配策略参数（FieldsAllocationStyle）和字段在Java源码中定义顺序的影响。<ul>
<li>相同宽度的字段被分配在一起</li>
<li>父类中定义的变量会出现在自雷之前。</li>
</ul>
</li>
</ul>
</li>
<li>对齐填充（Padding）<ul>
<li>对象的大小必须是8字节的整数倍。</li>
</ul>
</li>
</ul>
<h4 id="对象的访问定位"><a href="#对象的访问定位" class="headerlink" title="对象的访问定位"></a>对象的访问定位</h4><ul>
<li>Java程序需要通过栈上的<strong>reference数据</strong>来操作堆上的具体对象。</li>
<li>使用句柄的话，Java堆中会划分出一块内存来作为句柄池，reference中存储的就是对象的句柄地址。据病种包含了对象<strong>实例数据</strong>与<strong>类型数据</strong>各自的具体地址信息。<ul>
<li>优点：对象被移动时，只要改变据病种的实例数据指针，reference本身不需要改变。</li>
</ul>
</li>
<li>使用直接指针访问的话，Java堆对象的布局中就必须考虑放置访问类型数据相关信息。<ul>
<li>好处：速度更快，节省了一次指针定位的时间开销。</li>
</ul>
</li>
</ul>
<h3 id="OOM异常实战"><a href="#OOM异常实战" class="headerlink" title="OOM异常实战"></a>OOM异常实战</h3><h4 id="Java堆溢出"><a href="#Java堆溢出" class="headerlink" title="Java堆溢出"></a>Java堆溢出</h4><ul>
<li>通过内存映像分析工具对Dump出来的<strong>堆转储快照</strong>进行分析，确认内存中的对象是否是必要的，也就是分清楚是内存泄漏(Memory Leak)还是内存溢出（Memory Overflow）。</li>
<li>内存泄漏（GC无法回收它们）<ul>
<li>通过工具查看泄漏对象是通过怎样的路径与<strong>GC Roots</strong>相关联，并导致垃圾回收器，无法自动回收它们的。</li>
</ul>
</li>
<li>内存溢出（对象都必须存活）<ul>
<li>检查堆参数（Xms和Xmx）与物理内存的比例看是否还可以增大。</li>
<li>从代码上检查是否存在某些对象<strong>生命周期过长</strong>，<strong>持有状态时间过长</strong>。</li>
</ul>
</li>
</ul>
<h4 id="虚拟机栈和本地方法栈溢出"><a href="#虚拟机栈和本地方法栈溢出" class="headerlink" title="虚拟机栈和本地方法栈溢出"></a>虚拟机栈和本地方法栈溢出</h4><ul>
<li>如果线程请求的栈深度大于虚拟机所允许的最大深度，StackOverflowError.</li>
<li>如果虚拟机在扩展式无法申请到足够的内存空间，OutMemoryError.</li>
<li>在单个线程下，虚拟机抛出都是StackOverflowError。</li>
</ul>
<h4 id="方法区和运行时常量池溢出"><a href="#方法区和运行时常量池溢出" class="headerlink" title="方法区和运行时常量池溢出"></a>方法区和运行时常量池溢出</h4><ul>
<li>String.intern()</li>
</ul>
<h4 id="本机内存直接溢出"><a href="#本机内存直接溢出" class="headerlink" title="本机内存直接溢出"></a>本机内存直接溢出</h4><ul>
<li>特征是在Heap Dump文件中不会看见明显的异常，如果发现OOM之后Dump文件很小，程序又使用了NIO，可以考虑一下这个原因。</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/08/TensorFlow入门——MNIST手写字符识别/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/08/TensorFlow入门——MNIST手写字符识别/" itemprop="url">
                  TensorFlow入门——MNIST手写字符识别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-08T22:01:55+08:00">
                2017-04-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/机器学习/" itemprop="url" rel="index">
                    <span itemprop="name">机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>内容翻译自<a href="https://www.tensorflow.org/get_started/mnist/pros" target="_blank" rel="external">Deep MNIST for Experts</a></p>
<p>本文可能插入TensorFlow官网上的图片或者链接，需翻墙可以加载或访问。</p>
<p>TenforFlow是一个强大的大规模数字计算的软件包。它擅长的功能之一是实现并且训练深度神经网络。在这个教程中，我们将会学习构建一个基本的深度卷积MNIST分类模型，</p>
<h2 id="关于这个教程"><a href="#关于这个教程" class="headerlink" title="关于这个教程"></a>关于这个教程</h2><p>这个教程的第一部分解释在<a href="https://www.tensorflow.org/code/tensorflow/examples/tutorials/mnist/mnist_softmax.py" target="_blank" rel="external">mnist_softmax.py</a>代码中实现了什么，这是TensorFlow模型实现的基础。第二部分展示一些提高精确度的方法。</p>
<p>在这个教程中我们将会完成以下几点：</p>
<ul>
<li>建立一个softmax回归函数作为识别MNIST数字的模型，基于观察图片中的每一个像素。</li>
<li>使用TensorFlow训练这个模型去识别图片，通过观察成千的样本。</li>
<li>使用测试数据验证模型的精确度。</li>
<li>建立、训练、测试一个多层卷积神经网络，来提升结果。</li>
</ul>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>开始之前，要先加载MNIST数据集，然后开始一个TensorFlow session</p>
<h3 id="加载MNIST数据"><a href="#加载MNIST数据" class="headerlink" title="加载MNIST数据"></a>加载MNIST数据</h3><p>复制粘贴下面的代码，程序会自动下载读取数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> tensorflow.examples.tutorials.mnist <span class="keyword">import</span> input_data</div><div class="line">mnist = input_data.read_data_sets(<span class="string">'MNIST_data'</span>, one_hot=<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p>这里<code>mnist</code>是一个轻量的类储存训练、验证、测试数据，以NumPy数组的方式。其也提供了一个迭代小批的函数，我们下面会用到。</p>
<h3 id="开始TensorFlow-InterativeSession"><a href="#开始TensorFlow-InterativeSession" class="headerlink" title="开始TensorFlow InterativeSession"></a>开始TensorFlow InterativeSession</h3><p>TensorFlow在后端依靠高效的C++来执行计算。与后端的连接叫做<code>sessioin</code>。TensorFlow程序常见的用法是创建一个<code>graph</code>，然后再一个<code>session</code>中启动它。</p>
<p>这里我们选择使用方便的<code>InteractiveSession</code>类，它会让TensorFlow中你组织你的代码更灵活。它循序你交替运行建立一个计算图和运行这个图的操作。（ It allows you tointerleave operations which build a <a href="https://www.tensorflow.org/get_started/get_started#the_computational_graph" target="_blank" rel="external">computation graph</a> with ones that run the graph. ）这在例如IPython的交互式的环境中特别方便。如果你不使用<code>InteractiveSesion</code>，你应该建立一个完整的图在你启动session和运行这个图之前。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line">sess = tf.InteractiveSession()</div></pre></td></tr></table></figure>
<h3 id="计算图"><a href="#计算图" class="headerlink" title="计算图"></a>计算图</h3><p>为了在Python中高效的进行数值计算，我们使用像NumPy的包来在Python以外进行重量级运算，例如矩阵乘法。不幸的是，每个操作仍然有很多切换回Python的开销。如果你想运行这些计算在GPU上或者以分布式的形式这些在转换数据时有大量消耗的方式，这些开销变的相当昂贵。</p>
<p>TensorFlow也是把这些重量操作放在Python外面，但是它做了一些设定去避免这些开销。TensorFlow允许我们描述一个图在Python外面运行的交互操作，而不是使用Python运行一个单独的重量操作。这个方法和在Theano和Torch中的方法很像。</p>
<p>Python代码的作用是建立一个外部计算图，然后命令运算图的哪一部分应该被执行。查看<a href="https://www.tensorflow.org/get_started/get_started#the_computational_graph" target="_blank" rel="external">Computation Graph</a>和<a href="https://www.tensorflow.org/get_started/get_started" target="_blank" rel="external">Getting Started With TensorFlow</a>获得更多细节。</p>
<h2 id="建立一个Softmax回归模型"><a href="#建立一个Softmax回归模型" class="headerlink" title="建立一个Softmax回归模型"></a>建立一个Softmax回归模型</h2><p>在这一部分，我们建立一个单层softmax回归模型，下一节我们将模型扩展为多层卷积网络。</p>
<h3 id="占位符"><a href="#占位符" class="headerlink" title="占位符"></a>占位符</h3><p>我们通过创建输入图像的节点和输出类别的节点来建立计算图：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">x = tf.placeholder(tf.float32, shape=[<span class="keyword">None</span>, <span class="number">784</span>])</div><div class="line">y_ = tf.placeholder(tf.float32, shape=[<span class="keyword">None</span>, <span class="number">10</span>])</div></pre></td></tr></table></figure>
<p>输入的图像x由二维浮点数<code>tensor</code>组成。我们分配一个<code>[None,784]</code> 的<code>shape</code>。784是28*28图像，None代表第一位由每一批的数量决定。目标输出类别<code>y_</code>由二维<code>tensor</code>组成，每行是一个十维的矢量表示类别（0或者1）。</p>
<p><code>placeholder</code> 的<code>shape</code>参数是可选择的，但是它允许TensorFlow在<code>shape</code>不一致的时候自动的捕获bug。</p>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>我们定义权重<code>W</code>和偏置量<code>b</code>，我们可以设想通过额外的输入训练这些量。但是TensorFlow有一种更好的方式管理他们：<code>variable</code>。一个<code>varable</code>是TensorFlow的计算图中的一个值。他可以根据计算修改。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">W = tf.Variable(tf.zeros([<span class="number">784</span>,<span class="number">10</span>]))</div><div class="line">b = tf.Variable(tf.zeros([<span class="number">10</span>]))</div></pre></td></tr></table></figure>
<p>我们在调用<code>tf.Variable</code>的时候传入一个初始值。在这个例子中，我们将w和b都初始为0.</p>
<p>在<code>Varialbe</code>在session中调用之前，他们必须使用这个session初始化。这一步让已经指定的初始值赋值给每个变量。可以为所有变量一次性全部初始化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sess.run(tf.global_variables_initializer())</div></pre></td></tr></table></figure>
<h3 id="预测类别以及损失函数"><a href="#预测类别以及损失函数" class="headerlink" title="预测类别以及损失函数"></a>预测类别以及损失函数</h3><p>我们现在可以实现我们的回归模型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">y = tf.matmul(x,W) + b</div></pre></td></tr></table></figure>
<p>我们可以和这一样简单的指定损失函数。这里，我们的损失函数是目标和这个预测模型softmax激活函数的交叉熵。作为初级教程，我们使用这个保险的形式:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cross_entropy = tf.reduce_mean(</div><div class="line">    tf.nn.softmax_cross_entropy_with_logits(labels=y_, logits=y))</div></pre></td></tr></table></figure>
<p>注意这里<code>tf.nn.softmax_corss_entropy_with_logits</code>internally(内部地) applies the softmax on the model’s unnormalized model prediction and sums across all classes。<code>tf.reduce_mean</code>求这些和的平均数。</p>
<h2 id="训练这个模型"><a href="#训练这个模型" class="headerlink" title="训练这个模型"></a>训练这个模型</h2><p>现在我们已经定义了我们的模型和损失函数，这让使用TensorFlow训练很简单。因为TensorFlow知道了所有的计算图，他可以使用自动的计算损失函数对于每一个变量的导数。TensorFlow有很多不同的<a href="https://www.tensorflow.org/api_guides/python/train#optimizers" target="_blank" rel="external">自带最优化算法</a>。例如我们使用梯度下降法，步长0.5去减少交叉熵：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">train_step = tf.train.GradientDescentOptimizer(<span class="number">0.5</span>).minimize(cross_entropy)</div></pre></td></tr></table></figure>
<p>这里在计算图上增加了一个新的操作，这个操作包含计算梯度、计算参数更新量、然后更新参数。</p>
<p>运行时被返回的操作<code>train_step</code>会应用到梯度下降中更新参数。因此，训练这个模型可以不停的运行<code>train_step</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">  batch = mnist.train.next_batch(<span class="number">100</span>)</div><div class="line">  train_step.run(feed_dict=&#123;x: batch[<span class="number">0</span>], y_: batch[<span class="number">1</span>]&#125;)</div></pre></td></tr></table></figure>
<p>我们在每次训练迭代的时候加载100条训练样本。当我们运行<code>train_step</code>操作，使用<code>feed_dict</code>去取代<code>placeholder</code>tensors<code>x</code>和<code>y_</code>。注意，你可以使用<code>feed_dict</code>替代任何tensor在你的计算图中，不仅仅是<code>placeholder</code>.</p>
<h3 id="评价这个模型"><a href="#评价这个模型" class="headerlink" title="评价这个模型"></a>评价这个模型</h3><p>首先我们计算出我们预测正确标签的位置。<code>tf.argmax</code>是一个特别有用的函数，可以给你tensor中最高标量的索引。例如<code>tf.argmax(y,1)</code>是我们模型认为最有可能的结果，当<code>tf.argmax(y_,1)</code>是一个正确的标签。我们使用<code>tf.equal</code>去检查我们的预测是否正确：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">correct_prediction = tf.equal(tf.argmax(y,<span class="number">1</span>), tf.argmax(y_,<span class="number">1</span>))</div></pre></td></tr></table></figure>
<p>返回我们一个布尔值。为了确定正确率，我们转换为浮点数，然后计算他们的平均数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))</div></pre></td></tr></table></figure>
<p>最终我们评价在测试数据上的精确度：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(accuracy.eval(feed_dict=&#123;x: mnist.test.images, y_: mnist.test.labels&#125;))</div></pre></td></tr></table></figure>
<h2 id="构建一个多层卷积网络"><a href="#构建一个多层卷积网络" class="headerlink" title="构建一个多层卷积网络"></a>构建一个多层卷积网络</h2><h3 id="权重初始化"><a href="#权重初始化" class="headerlink" title="权重初始化"></a>权重初始化</h3><p>为了建立这个模型，我们将需要很多权重和偏置量。应该用一个很小的量初始化这些权重来打破对称，和预防0梯度。所以，我们使用<a href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks" target="_blank" rel="external">ReLU</a>)神经细胞。用一些小的正值初始化偏置量可以避免”死神经细胞“。为了防止在建立模型时重复这一过程，我们建立两个方便的函数去做这些事情：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">weight_variable</span><span class="params">(shape)</span>:</span></div><div class="line">  initial = tf.truncated_normal(shape, stddev=<span class="number">0.1</span>)</div><div class="line">  <span class="keyword">return</span> tf.Variable(initial)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bias_variable</span><span class="params">(shape)</span>:</span></div><div class="line">  initial = tf.constant(<span class="number">0.1</span>, shape=shape)</div><div class="line">  <span class="keyword">return</span> tf.Variable(initial)</div></pre></td></tr></table></figure>
<h3 id="卷积和池化"><a href="#卷积和池化" class="headerlink" title="卷积和池化"></a>卷积和池化</h3><p>TensorFlow也给予我们在在卷积和池化中很多灵活性。我们要怎样处理边界？步长多少？在这个例子中，我们将选择vanilla版本。我们的卷积使用步长1，pad 0.所以，输出和输入的规格是一样的。我们2*2格子中选择最大池化。为了保持代码整洁，仍然建立两个函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">conv2d</span><span class="params">(x, W)</span>:</span></div><div class="line">  <span class="keyword">return</span> tf.nn.conv2d(x, W, strides=[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">max_pool_2x2</span><span class="params">(x)</span>:</span></div><div class="line">  <span class="keyword">return</span> tf.nn.max_pool(x, ksize=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>],</div><div class="line">                        strides=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding=<span class="string">'SAME'</span>)</div></pre></td></tr></table></figure>
<p><strong>padding</strong> :步长不能整除图片大小时边距的处理方法，“SAME”表示超过边界用0填充，使得输出保持和输入相同的大小，“VALID”表示不超过边界，通常会丢失一些信息。</p>
<h3 id="第一个卷积层"><a href="#第一个卷积层" class="headerlink" title="第一个卷积层"></a>第一个卷积层</h3><p>我们可以实现我们的第一层。卷积将会计算5*5patch的32个特征。权重tensor的shape是[5,5,1,32]。前两个维度是patch大小。下一个数字是输入频道数，最后一个是输出频道数。而且我们将为每个输出加上一个偏置量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">W_conv1 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">32</span>])</div><div class="line">b_conv1 = bias_variable([<span class="number">32</span>])</div></pre></td></tr></table></figure>
<p>我们先将<code>x</code>改造成4维的tensor。第二第三维对应图像的宽和长，最后一维对应彩色通道（channel）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">x_image = tf.reshape(x, [<span class="number">-1</span>,<span class="number">28</span>,<span class="number">28</span>,<span class="number">1</span>])</div></pre></td></tr></table></figure>
<p>使用权重卷积，加上偏置量，应用ReLU函数，最后最大池化。池化将会把图片大小改变为14*14.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">h_conv1 = tf.nn.relu(conv2d(x_image, W_conv1) + b_conv1)</div><div class="line">h_pool1 = max_pool_2x2(h_conv1)</div></pre></td></tr></table></figure>
<h3 id="第二个卷积层"><a href="#第二个卷积层" class="headerlink" title="第二个卷积层"></a>第二个卷积层</h3><p>第二层有对于每个5*5的patch，有64个特征。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">W_conv2 = weight_variable([<span class="number">5</span>, <span class="number">5</span>, <span class="number">32</span>, <span class="number">64</span>])</div><div class="line">b_conv2 = bias_variable([<span class="number">64</span>])</div><div class="line"></div><div class="line">h_conv2 = tf.nn.relu(conv2d(h_pool1, W_conv2) + b_conv2)</div><div class="line">h_pool2 = max_pool_2x2(h_conv2)</div></pre></td></tr></table></figure>
<h3 id="全连接层"><a href="#全连接层" class="headerlink" title="全连接层"></a>全连接层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">W_fc1 = weight_variable([<span class="number">7</span> * <span class="number">7</span> * <span class="number">64</span>, <span class="number">1024</span>])</div><div class="line">b_fc1 = bias_variable([<span class="number">1024</span>])</div><div class="line"></div><div class="line">h_pool2_flat = tf.reshape(h_pool2, [<span class="number">-1</span>, <span class="number">7</span>*<span class="number">7</span>*<span class="number">64</span>])</div><div class="line">h_fc1 = tf.nn.relu(tf.matmul(h_pool2_flat, W_fc1) + b_fc1)</div></pre></td></tr></table></figure>
<h3 id="Dropout"><a href="#Dropout" class="headerlink" title="Dropout"></a>Dropout</h3><p>为了减少过拟合，我们在输出之前应用<a href="https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf" target="_blank" rel="external">dropout</a>。我们创建一个神经元输出概率的<code>placeholder</code>。在训练的时候弃用，在测试的时候关闭。TensorFlow的<code>tf.nn.dropout</code>自动的控制神经输出时mask他们。所以dropout不需要额外的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">keep_prob = tf.placeholder(tf.float32)</div><div class="line">h_fc1_drop = tf.nn.dropout(h_fc1, keep_prob)</div></pre></td></tr></table></figure>
<h3 id="输出层"><a href="#输出层" class="headerlink" title="输出层"></a>输出层</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">W_fc2 = weight_variable([<span class="number">1024</span>, <span class="number">10</span>])</div><div class="line">b_fc2 = bias_variable([<span class="number">10</span>])</div><div class="line"></div><div class="line">y_conv = tf.matmul(h_fc1_drop, W_fc2) + b_fc2</div></pre></td></tr></table></figure>
<h3 id="训练并且评价这个模型"><a href="#训练并且评价这个模型" class="headerlink" title="训练并且评价这个模型"></a>训练并且评价这个模型</h3><p>和softmax神经网络的区别：</p>
<ul>
<li>使用复杂的ADAM optimizer取代梯度下降法。</li>
<li>在<code>feed_dict</code> 中使用<code>keep_prob</code>控制dropout率。</li>
<li>训练过程中x每100次迭代输出一次日志。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">cross_entropy = tf.reduce_mean(</div><div class="line">    tf.nn.softmax_cross_entropy_with_logits(labels=y_, logits=y_conv))</div><div class="line">train_step = tf.train.AdamOptimizer(<span class="number">1e-4</span>).minimize(cross_entropy)</div><div class="line">correct_prediction = tf.equal(tf.argmax(y_conv,<span class="number">1</span>), tf.argmax(y_,<span class="number">1</span>))</div><div class="line">accuracy = tf.reduce_mean(tf.cast(correct_prediction, tf.float32))</div><div class="line">sess.run(tf.global_variables_initializer())</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">20000</span>):</div><div class="line">  batch = mnist.train.next_batch(<span class="number">50</span>)</div><div class="line">  <span class="keyword">if</span> i%<span class="number">100</span> == <span class="number">0</span>:</div><div class="line">    train_accuracy = accuracy.eval(feed_dict=&#123;</div><div class="line">        x:batch[<span class="number">0</span>], y_: batch[<span class="number">1</span>], keep_prob: <span class="number">1.0</span>&#125;)</div><div class="line">    print(<span class="string">"step %d, training accuracy %g"</span>%(i, train_accuracy))</div><div class="line">  train_step.run(feed_dict=&#123;x: batch[<span class="number">0</span>], y_: batch[<span class="number">1</span>], keep_prob: <span class="number">0.5</span>&#125;)</div><div class="line"></div><div class="line">print(<span class="string">"test accuracy %g"</span>%accuracy.eval(feed_dict=&#123;</div><div class="line">    x: mnist.test.images, y_: mnist.test.labels, keep_prob: <span class="number">1.0</span>&#125;))</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/07/TensorFlow入门——线性回归的例子/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/07/TensorFlow入门——线性回归的例子/" itemprop="url">
                  TensorFlow入门——线性回归的例子
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-07T18:31:37+08:00">
                2017-04-07
              </time>
            

            

            
          </span>

          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>翻译自<a href="https://www.tensorflow.org/get_started/get_started" target="_blank" rel="external">Getting Started With TensorFlow</a> </p>
<p>TensorFlow提供很多API，低级API<code>TensorFlow Core</code>提供完整的程序控制。向机器学习研究者和 其他想对自己的模型有良好控制的人推荐<code>TensorFlow Core</code>。高级API是在<code>Tensorflow Core</code>的上层上建立的。高级API比<code>TensorFlow Core</code>学习和使用都要简单。而且，高级API让重复性的任务更简单，在不同的用户手中更一致。高级API像<code>tf.contrib.learn</code>帮助你管理数据集，估计量（estimators），训练和推理（inference）。注意，一些高级API名字中带有<code>contrib</code>的仍在开发中，<code>contrib</code>方法可能会在后来的版本中弃用。</p>
<h2 id="Tensors"><a href="#Tensors" class="headerlink" title="Tensors"></a>Tensors</h2><p>TensorFlow里的核心数据元素是<code>tesnor</code>。一个<code>tensor</code>包含一个任何维度数组形式的原值的集合。<code>tensor</code>的<code>rank</code>是维度的数目。下面上一些例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="number">3</span> <span class="comment"># a rank 0 tensor; this is a (scalar)标量 with shape []</span></div><div class="line">[<span class="number">1.</span> ,<span class="number">2.</span>, <span class="number">3.</span>] <span class="comment"># a rank 1 tensor; this is a vector with shape [3]</span></div><div class="line">[[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>], [<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>]] <span class="comment"># a rank 2 tensor; a matrix with shape [2, 3]</span></div><div class="line">[[[<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>]], [[<span class="number">7.</span>, <span class="number">8.</span>, <span class="number">9.</span>]]] <span class="comment"># a rank 3 tensor with shape [2, 1, 3]</span></div></pre></td></tr></table></figure>
<h2 id="TensorFlow-Core-教程"><a href="#TensorFlow-Core-教程" class="headerlink" title="TensorFlow Core 教程"></a>TensorFlow Core 教程</h2><h3 id="Importing-TensorFlow"><a href="#Importing-TensorFlow" class="headerlink" title="Importing TensorFlow"></a>Importing TensorFlow</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div></pre></td></tr></table></figure>
<p>导入TensorFlow的所有classes，methods，symbols</p>
<h3 id="The-Computational-Graph"><a href="#The-Computational-Graph" class="headerlink" title="The Computational Graph"></a>The Computational Graph</h3><p>你可以把TensorFlow Core程序看成是两段的集合：</p>
<ol>
<li>建立计算图</li>
<li>运行计算图</li>
</ol>
<p>计算图（Computational Graph）是排列成图节点的一系列操作。每个节点将零个或多个tensor作为输入，产生一个tensor作为输出。constant是其中一种节点，它没有输入，输出一个内部储存的值。创建两个浮点数Tensors，<code>node1</code>和<code>node2</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">node1 = tf.constant(<span class="number">3.0</span>, tf.float32)</div><div class="line">node2 = tf.constant(<span class="number">4.0</span>) <span class="comment"># also tf.float32 implicitly</span></div><div class="line">print(node1, node2)</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Tensor(<span class="string">"Const:0"</span>, shape=(), dtype=float32) Tensor(<span class="string">"Const_1:0"</span>, shape=(), dtype=float32)</div></pre></td></tr></table></figure>
<p>并没有输出3.0和4.0。因为他们是节点（node），当我们evaluate时，会分别产生3.0和4.0。要想evaluate这些节点，我们必须使用session运行计算图。一个session内部封装了TensorFlow运行时刻的控制和状态。</p>
<p>下面的代码创建了一个<code>Session</code>对象，我们调用他的<code>run</code>方法去运行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sess = tf.Session()</div><div class="line">print(sess.run([node1, node2]))</div></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="number">3.0</span>,<span class="number">4.0</span>]</div></pre></td></tr></table></figure>
<p><strong>我运行还会出现很多错误：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; node1 = tf.constant(3.0,tf.float32)</div><div class="line">&gt;&gt;&gt; sess = tf.Session()</div><div class="line">&gt;&gt;&gt; print(sess.run(node1))</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;BestSplits&quot; device_type: &quot;CPU&quot;&apos;) fo</div><div class="line">r unknown op: BestSplits</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;CountExtremelyRandomStats&quot; device_t</div><div class="line">ype: &quot;CPU&quot;&apos;) for unknown op: CountExtremelyRandomStats</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;FinishedNodes&quot; device_type: &quot;CPU&quot;&apos;)</div><div class="line"> for unknown op: FinishedNodes</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;GrowTree&quot; device_type: &quot;CPU&quot;&apos;) for</div><div class="line">unknown op: GrowTree</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;ReinterpretStringToFloat&quot; device_ty</div><div class="line">pe: &quot;CPU&quot;&apos;) for unknown op: ReinterpretStringToFloat</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;SampleInputs&quot; device_type: &quot;CPU&quot;&apos;)</div><div class="line">for unknown op: SampleInputs</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;ScatterAddNdim&quot; device_type: &quot;CPU&quot;&apos;</div><div class="line">) for unknown op: ScatterAddNdim</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;TopNInsert&quot; device_type: &quot;CPU&quot;&apos;) fo</div><div class="line">r unknown op: TopNInsert</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;TopNRemove&quot; device_type: &quot;CPU&quot;&apos;) fo</div><div class="line">r unknown op: TopNRemove</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;TreePredictions&quot; device_type: &quot;CPU&quot;</div><div class="line">&apos;) for unknown op: TreePredictions</div><div class="line">E c:\tf_jenkins\home\workspace\release-win\device\cpu\os\windows\tensorflow\core</div><div class="line">\framework\op_kernel.cc:943] OpKernel (&apos;op: &quot;UpdateFertileSlots&quot; device_type: &quot;C</div><div class="line">PU&quot;&apos;) for unknown op: UpdateFertileSlots</div><div class="line">3.0</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
<p>待搞明白。</p>
<p>我们可以建立更复杂的计算通过组合<code>Tensor</code>节点和操作（操作也是节点）。例如，我们可以把我们的两个常量节点相加，产生一个新的图（Graph）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">node3 = tf.add(node1, node2)</div><div class="line">print(<span class="string">"node3: "</span>, node3)</div><div class="line">print(<span class="string">"sess.run(node3): "</span>,sess.run(node3))</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">node3:  Tensor(<span class="string">"Add_2:0"</span>, shape=(), dtype=float32)</div><div class="line">sess.run(node3):  <span class="number">7.0</span></div></pre></td></tr></table></figure>
<p>TensorFlow 提供一个使用的TensorBoard可以展示计算图的图片。<img src="https://www.tensorflow.org/images/getting_started_add.png" alt="TensorBoard screenshot"></p>
<p>目前，图片没有特别英吹思婷，因为它经常产生恒定的结果。图可以使用参数表示外部的输入，就像<code>placeholders</code>。一个<code>placeholder</code>是一个后面会提供值的promise。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">a = tf.placeholder(tf.float32)</div><div class="line">b = tf.placeholder(tf.float32)</div><div class="line">adder_node = a + b  <span class="comment"># + provides a shortcut for tf.add(a, b)</span></div></pre></td></tr></table></figure>
<p>我们可以使用多个输入evaluate这个graph，通过使用feed_dict参数为这些placeholders提供常量去specifty Tensors。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">print(sess.run(adder_node, &#123;a: <span class="number">3</span>, b:<span class="number">4.5</span>&#125;))</div><div class="line">print(sess.run(adder_node, &#123;a: [<span class="number">1</span>,<span class="number">3</span>], b: [<span class="number">2</span>, <span class="number">4</span>]&#125;))</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">7.5</span></div><div class="line">[ <span class="number">3.</span>  <span class="number">7.</span>]</div></pre></td></tr></table></figure>
<p>在机器学习中，我们希望模型可以有任意输入。为了让模型可以训练，我们需要修改图去从相同的输入得到新的输出。<code>Variables</code>允许我们为图添加可训练的参数。他们由初始值和类型构成。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">W = tf.Variable([<span class="number">.3</span>], tf.float32)</div><div class="line">b = tf.Variable([<span class="number">-.3</span>], tf.float32)</div><div class="line">x = tf.placeholder(tf.float32)</div><div class="line">linear_model = W * x + b</div></pre></td></tr></table></figure>
<p><code>variables</code>不会在你使用<code>tf.Variable</code>的时候初始化。你必须明确的使用下面的操作去初始化所有的变量：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">init = tf.global_variables_initializer()</div><div class="line">sess.run(init)</div></pre></td></tr></table></figure>
<p><code>init</code>是TensorFlow子图中初始化所有全局变量的handle，一直到我们调用<code>sess.run</code>之前，这些变量都是未初始化的状态。</p>
<p>我们可以同时使用多个X的值计算(evaluate) <code>linear_model</code> ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">print(sess.run(linear_model, &#123;x:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]&#125;))</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ <span class="number">0.</span>          <span class="number">0.30000001</span>  <span class="number">0.60000002</span>  <span class="number">0.90000004</span>]</div></pre></td></tr></table></figure>
<p>我们使用标准的线性回归损失模型：计算当前预测值和实际值的平方和。<code>linear_model - y</code>。我们调用<code>tf.quare</code>，然后使用<code>tf.reduce_sum</code>相加。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">y = tf.placeholder(tf.float32)</div><div class="line">squared_deltas = tf.square(linear_model - y)</div><div class="line">loss = tf.reduce_sum(squared_deltas)</div><div class="line">print(sess.run(loss, &#123;x:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], y:[<span class="number">0</span>,<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>]&#125;))</div></pre></td></tr></table></figure>
<p>计算出损失值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">23.66</span></div></pre></td></tr></table></figure>
<p>变量以<code>tf.Variable</code>的值初始化，可以通过<code>tf.assign</code>操作改变。比如<code>W=-1,b=1</code>是模型的最佳参数，我们可以通过以下改变W和b的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fixW = tf.assign(W, [<span class="number">-1.</span>])</div><div class="line">fixb = tf.assign(b, [<span class="number">1.</span>])</div><div class="line">sess.run([fixW, fixb])</div><div class="line">print(sess.run(loss, &#123;x:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], y:[<span class="number">0</span>,<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>]&#125;))</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="number">0.0</span></div></pre></td></tr></table></figure>
<p>下面展示如何自动的找到模型的最佳参数。</p>
<h2 id="tf-train-API"><a href="#tf-train-API" class="headerlink" title="tf.train API"></a>tf.train API</h2><p>TensorFlow提供<code>optimizers</code>可以缓慢的改变变量，为了最小化损失函数。最简单的最优化算法是梯度下降法。它根据参数对于损失函数导数的大小改变每个参数。通常，计算符号求导很容易出错，而且没意思。所以，TensorFlow可以使用函数<code>tf.gradients</code>自动的求的导数，只要根据模型的描述。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.01</span>)</div><div class="line">train = optimizer.minimize(loss)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sess.run(init) <span class="comment"># reset values to incorrect defaults.</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">  sess.run(train, &#123;x:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>], y:[<span class="number">0</span>,<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>]&#125;)</div><div class="line"></div><div class="line">print(sess.run([W, b]))</div></pre></td></tr></table></figure>
<p>最终的模型参数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[array([<span class="number">-0.9999969</span>], dtype=float32), array([ <span class="number">0.99999082</span>],</div><div class="line"> dtype=float32)]</div></pre></td></tr></table></figure>
<p>TensorFlow提供常见模式、结构、功能的更高级抽象。下一节学习如何使用这些。</p>
<h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"></div><div class="line"><span class="comment"># Model parameters</span></div><div class="line">W = tf.Variable([<span class="number">.3</span>], tf.float32)</div><div class="line">b = tf.Variable([<span class="number">-.3</span>], tf.float32)</div><div class="line"><span class="comment"># Model input and output</span></div><div class="line">x = tf.placeholder(tf.float32)</div><div class="line">linear_model = W * x + b</div><div class="line">y = tf.placeholder(tf.float32)</div><div class="line"><span class="comment"># loss</span></div><div class="line">loss = tf.reduce_sum(tf.square(linear_model - y)) <span class="comment"># sum of the squares</span></div><div class="line"><span class="comment"># optimizer</span></div><div class="line">optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.01</span>)</div><div class="line">train = optimizer.minimize(loss)</div><div class="line"><span class="comment"># training data</span></div><div class="line">x_train = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</div><div class="line">y_train = [<span class="number">0</span>,<span class="number">-1</span>,<span class="number">-2</span>,<span class="number">-3</span>]</div><div class="line"><span class="comment"># training loop</span></div><div class="line">init = tf.global_variables_initializer()</div><div class="line">sess = tf.Session()</div><div class="line">sess.run(init) <span class="comment"># reset values to wrong</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">  sess.run(train, &#123;x:x_train, y:y_train&#125;)</div><div class="line"></div><div class="line"><span class="comment"># evaluate training accuracy</span></div><div class="line">curr_W, curr_b, curr_loss  = sess.run([W, b, loss], &#123;x:x_train, y:y_train&#125;)</div><div class="line">print(<span class="string">"W: %s b: %s loss: %s"</span>%(curr_W, curr_b, curr_loss))</div></pre></td></tr></table></figure>
<h2 id="tf-contrib-learn"><a href="#tf-contrib-learn" class="headerlink" title="tf.contrib.learn"></a>tf.contrib.learn</h2><p><code>tf.contrib.learn</code>是高级TensorFlow包，简化了机器学习的机制，包括：</p>
<ul>
<li>运行训练循环</li>
<li>运行评价循环</li>
<li>管理数据集</li>
<li>管理输入（feeding？）</li>
</ul>
<p>tf.contrib.learn定义了很多的常见模型</p>
<h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p>使用<code>tf.contrib.learn</code>简化线性回归：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="comment"># NumPy 常常被用来加载、操作、预处理数据</span></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line"><span class="comment"># 声明特征List. 我们只有一个实值（real-valued）特征. There are many other types of columns that are more complicated and useful.</span></div><div class="line">features = [tf.contrib.layers.real_valued_column(<span class="string">"x"</span>, dimension=<span class="number">1</span>)]</div><div class="line"></div><div class="line"><span class="comment"># estimator在前端调用训练（fitting）和评价（ingerence）.有很多事先定义好的类型，比如说线性回归，罗杰斯特回归，线性分类，罗杰斯特分类，和很多神经网络分类和回归. 下面的代码提供一个线性回归estimator。</span></div><div class="line">estimator = tf.contrib.learn.LinearRegressor(feature_columns=features)</div><div class="line"></div><div class="line"><span class="comment"># Tensorflow提供了很多有用的方法读取和建立数据集. 这里我们使用`numpy_input_fn`.我们需要告诉函数，我们需要多少数据batches（num_epochs）和每个batch多大.</span></div><div class="line">x = np.array([<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>])</div><div class="line">y = np.array([<span class="number">0.</span>, <span class="number">-1.</span>, <span class="number">-2.</span>, <span class="number">-3.</span>])</div><div class="line"><span class="comment">#这里的num_epochs，和下面的steps是不是要一致？</span></div><div class="line">input_fn = tf.contrib.learn.io.numpy_input_fn(&#123;<span class="string">"x"</span>:x&#125;, y, batch_size=<span class="number">4</span>,</div><div class="line">                                              num_epochs=<span class="number">1000</span>)</div><div class="line"></div><div class="line"><span class="comment">#我们可以调用1000次训练步骤通过使用'fit'方法，然后输入训练数据集.</span></div><div class="line">estimator.fit(input_fn=input_fn, steps=<span class="number">1000</span>)</div><div class="line"></div><div class="line"><span class="comment">#这里我们评价我们模型有多么合适，在一个实际例子中，我们使用分别评价(separate validation)和测试数据集去避免过拟合.</span></div><div class="line">estimator.evaluate(input_fn=input_fn)</div></pre></td></tr></table></figure>
<p>疑惑：separate validation?  num_epochs?</p>
<h3 id="一个自定义模型"><a href="#一个自定义模型" class="headerlink" title="一个自定义模型"></a>一个自定义模型</h3><p><code>tf.contrib.learn</code>不会把你限制在这些预先定义的模型当中。假设我们想创建一个TensorFlow没有实现的自定义模型，我们仍然可以保持<code>tf.contrin.learn</code>对于数据集、输入(feeding)、训练的高度抽象。我们下面通过使用低级TensorFlowAPI来实现线性回归。</p>
<p>使用<code>tf.contrib.learn</code>自定义一个模型，我们需要使用<code>tf.contrib.learn.estimator</code>。<code>tf.contrib.learn.LinearRegressor</code>实际上是<code>tf.contrib.learn.Estimator</code>的一个子集。我们向提供<code>Estimator</code>一个函数 <code>model_fn</code>来告诉<code>tf.contrib.learn</code>要怎么样评价、预测、训练步数、损失函数。</p>
<p>完整代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="comment"># Declare list of features, we only have one real-valued feature</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">model</span><span class="params">(features, labels, mode)</span>:</span></div><div class="line">  <span class="comment"># Build a linear model and predict values</span></div><div class="line">  W = tf.get_variable(<span class="string">"W"</span>, [<span class="number">1</span>], dtype=tf.float64)</div><div class="line">  b = tf.get_variable(<span class="string">"b"</span>, [<span class="number">1</span>], dtype=tf.float64)</div><div class="line">  y = W*features[<span class="string">'x'</span>] + b</div><div class="line">  <span class="comment"># Loss sub-graph</span></div><div class="line">  loss = tf.reduce_sum(tf.square(y - labels))</div><div class="line">  <span class="comment"># Training sub-graph</span></div><div class="line">  global_step = tf.train.get_global_step()</div><div class="line">  optimizer = tf.train.GradientDescentOptimizer(<span class="number">0.01</span>)</div><div class="line">  train = tf.group(optimizer.minimize(loss),</div><div class="line">                   tf.assign_add(global_step, <span class="number">1</span>))</div><div class="line">  <span class="comment"># ModelFnOps connects subgraphs we built to the</span></div><div class="line">  <span class="comment"># appropriate functionality.</span></div><div class="line">  <span class="keyword">return</span> tf.contrib.learn.ModelFnOps(</div><div class="line">      mode=mode, predictions=y,</div><div class="line">      loss=loss,</div><div class="line">      train_op=train)</div><div class="line"></div><div class="line">estimator = tf.contrib.learn.Estimator(model_fn=model)</div><div class="line"><span class="comment"># define our data set</span></div><div class="line">x = np.array([<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>, <span class="number">4.</span>])</div><div class="line">y = np.array([<span class="number">0.</span>, <span class="number">-1.</span>, <span class="number">-2.</span>, <span class="number">-3.</span>])</div><div class="line">input_fn = tf.contrib.learn.io.numpy_input_fn(&#123;<span class="string">"x"</span>: x&#125;, y, <span class="number">4</span>, num_epochs=<span class="number">1000</span>)</div><div class="line"></div><div class="line"><span class="comment"># train</span></div><div class="line">estimator.fit(input_fn=input_fn, steps=<span class="number">1000</span>)</div><div class="line"><span class="comment"># evaluate our model</span></div><div class="line">print(estimator.evaluate(input_fn=input_fn, steps=<span class="number">10</span>))</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/06/LeetCode-一种递归除方法/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/06/LeetCode-一种递归除方法/" itemprop="url">
                  LeetCode_一种递归除方法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-06T23:15:21+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>LeetCode 29 不适用乘除求余运算，设计一个除法算法。</p>
<p>我的答案:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (ldivisor == <span class="number">0</span>) <span class="keyword">return</span> Integer.MAX_VALUE;</div><div class="line">	    <span class="keyword">if</span> ((ldividend == <span class="number">0</span>) || (ldividend &lt; ldivisor))	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	    </div><div class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">		<span class="keyword">if</span>(dividend&gt;=<span class="number">0</span>)</div><div class="line">			<span class="keyword">if</span>(divisor&gt;<span class="number">0</span>)</div><div class="line">				<span class="keyword">while</span>(dividend-divisor&gt;=<span class="number">0</span>)&#123;</div><div class="line">					dividend = dividend-divisor;</div><div class="line">					res++;</div><div class="line">				&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">				<span class="keyword">while</span>(dividend+divisor&gt;=<span class="number">0</span>)&#123;</div><div class="line">					dividend = dividend+divisor;</div><div class="line">					res--;</div><div class="line">				&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">if</span>(divisor&gt;<span class="number">0</span>)</div><div class="line">				<span class="keyword">while</span>(dividend+divisor&lt;=<span class="number">0</span>)&#123;</div><div class="line">					dividend = dividend+divisor;</div><div class="line">					res--;</div><div class="line">				&#125;</div><div class="line">			<span class="keyword">else</span></div><div class="line">				<span class="keyword">while</span>(dividend-divisor&lt;=<span class="number">0</span>)&#123;</div><div class="line">					dividend = dividend-divisor;</div><div class="line">					res++;</div><div class="line">				&#125;</div><div class="line">		<span class="keyword">return</span> res;</div></pre></td></tr></table></figure>
<p>不停的减，在被除数很大的时候会时间越界。</p>
<p>想到《算法》书里通过</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Pow(<span class="keyword">int</span> x,<span class="keyword">int</span> N)&#123;</div><div class="line">  <span class="keyword">if</span>(N==<span class="number">0</span>)</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">if</span>(IsEven(N))</div><div class="line">    <span class="keyword">return</span> Pow(x*x,N/<span class="number">2</span>);</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="keyword">return</span> Pow(x*x,N/<span class="number">2</span>)*x;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><a href="http://jlearning.cn/2017/03/23/%E3%80%8A%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E3%80%8B%EF%BC%881%EF%BC%89%E2%80%94%E2%80%94%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90/" target="_blank" rel="external">的方式求幂运算</a>想这里能不能也这样用。相比较$pow(x*x,N/2)=pow(x,N)$的方式进行转换，除法$X/Y=2X/2Y$好像在这里没用。</p>
<hr>
<p>找到被除数中最大2的幂，然后迭代：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span>((mi+mi)&lt;=dividend)&#123;</div><div class="line">  mi = mi+mi;</div><div class="line">  d = d+d;  </div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> d+divide(dividend-mi,divisor)</div></pre></td></tr></table></figure>
<p>相当于转化为二进制的形式。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/06/LeetCode-单链表K组翻转问题/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/06/LeetCode-单链表K组翻转问题/" itemprop="url">
                  LeetCode_单链表K组翻转问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-04-06T20:13:24+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>LeetCode 25. 每K为一组翻转单链表</p>
<p>例如：</p>
<p>Given this linked list: <code>1-&gt;2-&gt;3-&gt;4-&gt;5</code></p>
<p>For <em>k</em> = 2, you should return: <code>2-&gt;1-&gt;4-&gt;3-&gt;5</code></p>
<p>For <em>k</em> = 3, you should return: <code>3-&gt;2-&gt;1-&gt;4-&gt;5</code></p>
<p>伪代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//找到第K+1个节点，用curr指向他。</span></div><div class="line"><span class="keyword">while</span>(curr!=<span class="keyword">null</span>&amp;&amp;count!=k)&#123;</div><div class="line">  count++;</div><div class="line">  curr = curr.next;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(count == k)&#123;</div><div class="line">  curr = reverseKFGroup(curr,k);<span class="comment">//curr指向翻转后的K+1节点</span></div><div class="line">  <span class="comment">//下面开始翻转长度为k的单链表</span></div><div class="line">  <span class="comment">//head是第一个节点  curr是第k+1个节点</span></div><div class="line">  <span class="keyword">while</span>(count--&gt;<span class="number">0</span>)&#123;</div><div class="line">    ListNode temp = head.next;</div><div class="line">    head.next = curr;</div><div class="line">    curr = head;</div><div class="line">    head = temp;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//现在head是第k+1个节点，curr是第k个节点</span></div><div class="line">  head = curr;</div><div class="line">&#125;</div><div class="line"><span class="comment">//如果count！= k，那么不翻转这一部分，直接返回head</span></div><div class="line"><span class="keyword">return</span> head</div></pre></td></tr></table></figure>
<p>递归的思想。</p>
<p>另外翻转单链表的简洁表达。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/28/LeetCode42-Trapping-Rain-Water/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/28/LeetCode42-Trapping-Rain-Water/" itemprop="url">
                  LeetCode42-Trapping-Rain-Water
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-28T14:39:10+08:00">
                2017-03-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法题笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法题笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>我的算法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">trap</span><span class="params">(<span class="keyword">int</span>[] height)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l = height.length;</div><div class="line">		<span class="keyword">int</span> res = <span class="number">0</span>;</div><div class="line">		<span class="keyword">int</span> i = <span class="number">0</span>,j=l-<span class="number">1</span>;</div><div class="line">		<span class="keyword">while</span>(j&gt;i)&#123;</div><div class="line">			<span class="keyword">int</span> min = height[i]&gt;height[j]?height[j]:height[i];</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> m=i;m&lt;j;m++)&#123;</div><div class="line">				<span class="keyword">if</span>(height[m]&lt;min)&#123;</div><div class="line">					res+=min-height[m];</div><div class="line">					height[m]=min;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(height[j]&gt;height[i])&#123;</div><div class="line">				i++;</div><div class="line">			&#125;<span class="keyword">else</span>&#123;</div><div class="line">				j--;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>时间复杂度$O(N^2)$</p>
<p>Soluntion:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> left=<span class="number">0</span>; <span class="keyword">int</span> right=n<span class="number">-1</span>;</div><div class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> maxleft=<span class="number">0</span>, maxright=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</div><div class="line">            <span class="keyword">if</span>(A[left]&lt;=A[right])&#123;</div><div class="line">                <span class="keyword">if</span>(A[left]&gt;=maxleft) maxleft=A[left];</div><div class="line">                <span class="keyword">else</span> res+=maxleft-A[left];</div><div class="line">                left++;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">if</span>(A[right]&gt;=maxright) maxright= A[right];</div><div class="line">                <span class="keyword">else</span> res+=maxright-A[right];</div><div class="line">                right--;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>时间复杂度$O(N)$，用一次遍历解决问题。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/23/《数据结构与算法分析》（1）——算法分析/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/23/《数据结构与算法分析》（1）——算法分析/" itemprop="url">
                  《数据结构与算法分析》（1）——算法分析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-23T09:31:39+08:00">
                2017-03-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/读书笔记/" itemprop="url" rel="index">
                    <span itemprop="name">读书笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="数学理论"><a href="#数学理论" class="headerlink" title="数学理论"></a>数学理论</h3><ul>
<li>$\exists$正常数$c$和$n_0$使得当$N \geq n_0$时，$T(N)\leq cf(N)$,则记为$T(N)=O(f(N))$。</li>
<li>$\exists$正常数$c$和$n_0$使得当$N \geq n_0$时，$T(N)\geq cf(N)$,则记为$T(N)=\Omega(f(N))$。</li>
<li>$T(N) = \Theta(h(N))$当且仅当$T(N)=O(f(N))$且$T(N)=\Omega(f(N))$。</li>
<li>如果$T(N)=O(f(N))$且$T(N)\not=\Omega(f(N))$,则$T(N)=o(f(N))$。</li>
</ul>
<h3 id="如何评估时间复杂度"><a href="#如何评估时间复杂度" class="headerlink" title="如何评估时间复杂度"></a>如何评估时间复杂度</h3><p>***</p>
<h3 id="一个炸裂的例子"><a href="#一个炸裂的例子" class="headerlink" title="一个炸裂的例子"></a>一个炸裂的例子</h3><p>​    求最大的子序列和——时间复杂度从$O(N^3)$到$O(N^2)$到$O(Nlog(N))$到$O(N)$</p>
<h4 id="算法一"><a href="#算法一" class="headerlink" title="算法一"></a>算法一</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">msss1</span><span class="params">(<span class="keyword">int</span>[] sequence, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line"></div><div class="line">		<span class="keyword">int</span> ThisSum, MaxSum, i, j, k;</div><div class="line">		</div><div class="line">		MaxSum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)&#123;</div><div class="line">			<span class="keyword">for</span>(j=i;j&lt;N;j++)&#123;</div><div class="line">				ThisSum = <span class="number">0</span>;</div><div class="line">				<span class="keyword">for</span>(k=i;k&lt;=j;k++)&#123;</div><div class="line">					ThisSum+=sequence[k];</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(ThisSum&gt;MaxSum)&#123;</div><div class="line">					MaxSum = ThisSum;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> MaxSum;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>时间复杂度：$O(N^3)$</p>
<p>最直接的暴力解法。有很多重复计算，比如说<code>1+……+N</code>到<code>1+……+N+N+1</code>只需要加上一个<code>N+1</code>前面的部分不需要重复计算。所以有了算法二。</p>
<h4 id="算法二"><a href="#算法二" class="headerlink" title="算法二"></a>算法二</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">msss2</span><span class="params">(<span class="keyword">int</span>[] sequence, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line"></div><div class="line">		<span class="keyword">int</span> ThisSum, MaxSum, i, j, k;</div><div class="line">		</div><div class="line">		MaxSum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;i++)&#123;</div><div class="line">			ThisSum = <span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span>(j=i;j&lt;N;j++)&#123;</div><div class="line">				ThisSum+=sequence[j];</div><div class="line">				<span class="keyword">if</span>(ThisSum&gt;MaxSum)&#123;</div><div class="line">					MaxSum = ThisSum;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> MaxSum;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>时间复杂度：$O(N^2)$</p>
<h4 id="算法三"><a href="#算法三" class="headerlink" title="算法三"></a>算法三</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">msss4</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">int</span> ThisSum, MaxSum, j;</div><div class="line"></div><div class="line">  ThisSum = MaxSum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;N;j++)&#123;</div><div class="line">    ThisSum+=A[j];</div><div class="line">    <span class="keyword">if</span>(ThisSum&gt;MaxSum)</div><div class="line">      MaxSum = ThisSum;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(ThisSum&lt;<span class="number">0</span>)</div><div class="line">      ThisSum = <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> MaxSum;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>时间复杂度：$O(N)$</p>
<p>有DP算法的影子，用<code>Maxsum</code>储存到<code>j</code>点的最大序列和。如果$A[j]$是正的，就加上，如果是负的，就不变。因为初始值是0，和小于零，就为0。</p>
<h4 id="算法四"><a href="#算法四" class="headerlink" title="算法四"></a>算法四</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">msss3</span><span class="params">(<span class="keyword">int</span>[] A, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">		</div><div class="line">		<span class="keyword">int</span> MaxLeftSum, MaxRightSum;</div><div class="line">		<span class="keyword">int</span> MaxLeftBorderSum, MaxRightBorderSum;</div><div class="line">		<span class="keyword">int</span> LeftBorderSum, RightBorderSum;</div><div class="line">		<span class="keyword">int</span> Center,i;</div><div class="line">		</div><div class="line">		<span class="keyword">if</span>(left==right)</div><div class="line">			<span class="keyword">if</span>(A[left]&gt;<span class="number">0</span>)</div><div class="line">				<span class="keyword">return</span> A[left];</div><div class="line">			<span class="keyword">else</span></div><div class="line">				<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		</div><div class="line">		Center = (left+right)/<span class="number">2</span>;</div><div class="line">		MaxLeftSum = msss3(A,left,Center);</div><div class="line">		MaxRightSum = msss3(A,Center+<span class="number">1</span>,right);</div><div class="line">		</div><div class="line">		MaxLeftBorderSum = <span class="number">0</span>;</div><div class="line">		LeftBorderSum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i = Center;i&gt;=left;i--)&#123;</div><div class="line">			LeftBorderSum+=A[i];</div><div class="line">			<span class="keyword">if</span>(LeftBorderSum&gt;MaxLeftBorderSum)</div><div class="line">				MaxLeftBorderSum = LeftBorderSum;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		MaxRightBorderSum = <span class="number">0</span>;</div><div class="line">		RightBorderSum = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(i = Center+<span class="number">1</span>;i&lt;=right;i++)&#123;</div><div class="line">			RightBorderSum+=A[i];</div><div class="line">			<span class="keyword">if</span>(RightBorderSum&gt;MaxRightBorderSum)</div><div class="line">				MaxRightBorderSum = RightBorderSum;</div><div class="line">		&#125;</div><div class="line">		</div><div class="line">		<span class="keyword">return</span> Max3(MaxLeftBorderSum+MaxRightBorderSum,MaxLeftSum,MaxRightSum);</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>秀分治算法。代码复杂，程序消耗了大量时间初始化变量，赋值等操作。</p>
<p>时间复杂度：$O(NlogN)$</p>
<h3 id="评估欧几里德算法的时间复杂度"><a href="#评估欧几里德算法的时间复杂度" class="headerlink" title="评估欧几里德算法的时间复杂度"></a>评估欧几里德算法的时间复杂度</h3><p>算法如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Gcd</span><span class="params">(<span class="keyword">int</span> M, <span class="keyword">int</span> N)</span> </span>&#123;</div><div class="line">  <span class="comment">// TODO Auto-generated method stub</span></div><div class="line">  <span class="keyword">int</span> rem;</div><div class="line">  <span class="keyword">while</span>(N&gt;<span class="number">0</span>)&#123;</div><div class="line">    rem = M % N;</div><div class="line">    M = N;</div><div class="line">    N = rem;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> M;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>$\because M mod N&lt;M/2$</p>
<p>迭代次数最多是$2logN$，时间复杂度为$O(logN)$。</p>
<h3 id="评估幂运算的时间复杂度"><a href="#评估幂运算的时间复杂度" class="headerlink" title="评估幂运算的时间复杂度"></a>评估幂运算的时间复杂度</h3><p>算法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Pow(<span class="keyword">int</span> x,<span class="keyword">int</span> N)&#123;</div><div class="line">  <span class="keyword">if</span>(N==<span class="number">0</span>)</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">if</span>(IsEven(N))</div><div class="line">    <span class="keyword">return</span> Pow(x*x,N/<span class="number">2</span>);</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="keyword">return</span> Pow(x*x,N/<span class="number">2</span>)*x;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>if</code>语句里，第一种情况用了一个乘法，第二钟情况用了两个乘法。所以最多执行了$2logN$次乘法。</p>
<p>时间复杂度：$O(logN)$</p>
<p>另外一种方法：将<code>Pow(x*x,N/2)</code>替换为<code>Pow(x,N/2)*Pow(x,N/2)</code>，求时间复杂度。</p>
<p>$T(0)=1$</p>
<p>$T(N)=2*T(N/2)+1$</p>
<p>$T(2) = 2*T(1)+1=3$</p>
<p>$T(4)=2*T(2)+1=7$</p>
<p>$T(8)=2*T(4)+1=15$</p>
<p>$T(2^k) = 2^{k+1}-1$</p>
<p>$N = 2^k$ </p>
<p>$T(N)=2^{logN+1}-1=2N-1=O(N)$</p>
<h3 id="粗心的使用递归的后果"><a href="#粗心的使用递归的后果" class="headerlink" title="粗心的使用递归的后果"></a>粗心的使用递归的后果</h3><p>幂运算时，不能用<code>Pow(Pow(x,2),N/2)</code>来递归，因为如果<code>N=2</code>那么会产生一个无限循环。</p>
<hr>
<p>一个小问题：</p>
<p>在测试算法过程中写了一段这样的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">long</span> starTime = System.nanoTime();</div><div class="line"><span class="keyword">long</span> endTime1 = System.nanoTime();</div><div class="line"><span class="keyword">long</span> endTime2 = System.nanoTime();</div><div class="line"></div><div class="line">System.out.println(<span class="string">"algorithm1 cost time: "</span>+(endTime1-starTime));</div><div class="line">System.out.println(<span class="string">"algorithm2 cost time: "</span>+(endTime2-endTime1));</div></pre></td></tr></table></figure>
<p>输出不确定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">algorithm1 cost time: 892</div><div class="line">algorithm2 cost time: 0</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">algorithm1 cost time: 446</div><div class="line">algorithm2 cost time: 0</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">algorithm1 cost time: 0</div><div class="line">algorithm2 cost time: 446</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">//这种情况比较少出现</div><div class="line">algorithm1 cost time: 446</div><div class="line">algorithm2 cost time: 447</div></pre></td></tr></table></figure>
<p>Why？</p>
<p>还有，发现<code>System.out.println</code>消耗的时间比一个算法消耗的时间大很多，而且第二次调用<code>System.out.println</code>要比第一次少一个数量级（少数情况出现比第一次还多的情况）。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/22/LeetCode10-Regular-Expression-Matching/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/22/LeetCode10-Regular-Expression-Matching/" itemprop="url">
                  LeetCode10_Regular_Expression_Matching-DP动态规划问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-22T10:08:53+08:00">
                2017-03-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法题笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法题笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>动态规划的总结整理自：<a href="http://blog.csdn.net/baidu_28312631/article/details/47418773" target="_blank" rel="external">http://blog.csdn.net/baidu_28312631/article/details/47418773</a></p>
<h3 id="动态规划问题的一般转化方法"><a href="#动态规划问题的一般转化方法" class="headerlink" title="动态规划问题的一般转化方法"></a>动态规划问题的一般转化方法</h3><p>​    递归函数有n个参数，就定义一个n维的数组，数组的下标是递归函数参数的取值范围，数组元素的值是递归函数的返回值，这样就可以从边界值开始， 逐步填充数组，相当于计算递归函数值的逆过程。</p>
<h3 id="动态规划解题的一般思路"><a href="#动态规划解题的一般思路" class="headerlink" title="动态规划解题的一般思路"></a>动态规划解题的一般思路</h3><h4 id="将原问题分解为子问题"><a href="#将原问题分解为子问题" class="headerlink" title="将原问题分解为子问题"></a>将原问题分解为子问题</h4><p>​    把原问题分解为若干个子问题，子问题和原问题形式相同或类似，只不过规模变小了。子问题都解决，原问题即解决。<br>​    <strong>子问题的解一旦求出就会被<u>保存</u>，所以每个子问题只需求 解一次。</strong></p>
<h4 id="确定状态"><a href="#确定状态" class="headerlink" title="确定状态"></a>确定状态</h4><p>​    在用动态规划解题时，我们往往将和子问题相关的各个变量的一组取值，称之为一个“状 态”。一个“状态”对应于一个或多个子问题， 所谓某个“状态”下的“值”，就是这个“状 态”所对应的子问题的解。</p>
<h4 id="确定一些初始状态（边界状态）的值"><a href="#确定一些初始状态（边界状态）的值" class="headerlink" title="确定一些初始状态（边界状态）的值"></a>确定一些初始状态（边界状态）的值</h4><h4 id="确定状态转移方程"><a href="#确定状态转移方程" class="headerlink" title="确定状态转移方程"></a>确定状态转移方程</h4><p>​    如何从一个或多个“值”已知的 “状态”，求出另一个“状态”的“值”(递推型)。状态的迁移可以用递推公式表示，此递推公式也可被称作“状态转移方程”。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isMatch</span><span class="params">(String s, String p)</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (s == <span class="keyword">null</span> || p == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[s.length()+<span class="number">1</span>][p.length()+<span class="number">1</span>];</div><div class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; p.length(); i++) &#123;</div><div class="line">        <span class="keyword">if</span> (p.charAt(i) == <span class="string">'*'</span> &amp;&amp; dp[<span class="number">0</span>][i-<span class="number">1</span>]) &#123;</div><div class="line">            dp[<span class="number">0</span>][i+<span class="number">1</span>] = <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; s.length(); i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; p.length(); j++) &#123;</div><div class="line">            <span class="keyword">if</span> (p.charAt(j) == <span class="string">'.'</span>) &#123;</div><div class="line">                dp[i+<span class="number">1</span>][j+<span class="number">1</span>] = dp[i][j];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (p.charAt(j) == s.charAt(i)) &#123;</div><div class="line">                dp[i+<span class="number">1</span>][j+<span class="number">1</span>] = dp[i][j];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (p.charAt(j) == <span class="string">'*'</span>) &#123;</div><div class="line">                <span class="keyword">if</span> (p.charAt(j-<span class="number">1</span>) != s.charAt(i) &amp;&amp; p.charAt(j-<span class="number">1</span>) != <span class="string">'.'</span>) &#123;</div><div class="line">                    dp[i+<span class="number">1</span>][j+<span class="number">1</span>] = dp[i+<span class="number">1</span>][j-<span class="number">1</span>];</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    dp[i+<span class="number">1</span>][j+<span class="number">1</span>] = (dp[i+<span class="number">1</span>][j] || dp[i][j+<span class="number">1</span>] || dp[i+<span class="number">1</span>][j-<span class="number">1</span>]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> dp[s.length()][p.length()];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>附：</strong>最长递增子序列问题，将事件复杂度从$N^2$变为$Nlog(N)$:<a href="https://www.felix021.com/blog/read.php?1587" target="_blank" rel="external">https://www.felix021.com/blog/read.php?1587</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/21/LeetCode9-Palindrome-Number/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/21/LeetCode9-Palindrome-Number/" itemprop="url">
                  LeetCode9_Palindrome_Number
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-21T15:23:53+08:00">
                2017-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法题笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法题笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>LeetCode9-Palindrome-Number</p>
<p>判断一个int是否为回文数，不能使用额外的空间。</p>
<ol>
<li>负数能不能是回文数？</li>
<li>转换为String会占用额外的空间。</li>
<li>翻转int的话会造成int溢出。</li>
</ol>
<p>Beta：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(x&lt;<span class="number">10</span>&amp;&amp;x&gt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        <span class="keyword">int</span> b = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(x&gt;<span class="number">0</span>)&#123;</div><div class="line">            b = b*<span class="number">10</span>+x%<span class="number">10</span>;</div><div class="line">            x = x/<span class="number">10</span>;</div><div class="line">            <span class="keyword">if</span>(b==x)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>输入121判断不对-&gt;只考虑了偶数个字符数-&gt;分两种情况考虑</p>
<p>添加代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span>(x&gt;<span class="number">0</span>)&#123;</div><div class="line">            b = b*<span class="number">10</span>+x%<span class="number">10</span>;</div><div class="line">            <span class="keyword">if</span>(b==x)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">            x = x/<span class="number">10</span>;</div><div class="line">            <span class="keyword">if</span>(b==x)&#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>对于输入10判断不对-&gt;不适用于以0结尾-&gt;0结尾的都不是回文数</p>
<p>添加判断：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (x&lt;<span class="number">0</span> || (x!=<span class="number">0</span> &amp;&amp; x%<span class="number">10</span>==<span class="number">0</span>)) <span class="keyword">return</span> <span class="keyword">false</span>;</div></pre></td></tr></table></figure>
<p>accepted。还是占用了一个int b的额外空间。</p>
<p>Solutions:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x&lt;<span class="number">0</span> || (x!=<span class="number">0</span> &amp;&amp; x%<span class="number">10</span>==<span class="number">0</span>)) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">int</span> rev = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (x&gt;rev)&#123;</div><div class="line">    	rev = rev*<span class="number">10</span> + x%<span class="number">10</span>;</div><div class="line">    	x = x/<span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> (x==rev || x==rev/<span class="number">10</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>减少一半的计算量。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/03/21/LeetCode206-Reverse-Linked-List/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Zhuo Jimmy">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="jlearning.cn">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="jlearning.cn" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/21/LeetCode206-Reverse-Linked-List/" itemprop="url">
                  LeetCode206_Reverse_Linked_List
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-03-21T09:36:27+08:00">
                2017-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法题笔记/" itemprop="url" rel="index">
                    <span itemprop="name">算法题笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>翻转单链表，一个很经典的问题，有两种截然不同的思路。迭代（Lterative）和递归（Recursive）。</p>
<p>以下文章翻译自<a href="https://leetcode.com/articles/reverse-linked-list/" target="_blank" rel="external">https://leetcode.com/articles/reverse-linked-list/</a></p>
<h3 id="lterative递归"><a href="#lterative递归" class="headerlink" title="lterative递归"></a>lterative递归</h3><p>​    假设我们有一个链表<code>1-&gt;2-&gt;3-&gt;∅</code>,我们将这个链表翻转为<code>∅&lt;-1&lt;-2&lt;-3</code>。</p>
<p>​    当我们遍历这个链表，改变当前节点的next指针去指向他的前一个元素。由于每个节点不存储他的前向节点，所以你必须要先存储他的前向节点。你还需要在改变他的next指针之前，使用另一个指针去存储他的next节点。不要忘记在最后返回他的新头节点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">    ListNode prev = <span class="keyword">null</span>;</div><div class="line">    ListNode curr = head;</div><div class="line">    <span class="keyword">while</span> (curr != <span class="keyword">null</span>) &#123;</div><div class="line">        ListNode nextTemp = curr.next;</div><div class="line">        curr.next = prev;</div><div class="line">        prev = curr;</div><div class="line">        curr = nextTemp;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> prev;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="复杂度分析"><a href="#复杂度分析" class="headerlink" title="复杂度分析"></a>复杂度分析</h4><ul>
<li>时间复杂度：$O(n)$</li>
<li>空间复杂度：$O(1)$</li>
</ul>
<h3 id="Recursive迭代"><a href="#Recursive迭代" class="headerlink" title="Recursive迭代"></a>Recursive迭代</h3><p>​    迭代版本有些复杂，关键点在于向后发展。假设链表剩下的部分已经被翻转，现在我们如何翻转前面的部分？让我们假设链表为：<code>n1-&gt;...-&gt;nk-1-&gt;nk-&gt;nk+1-&gt;...-&gt;nm-&gt;∅</code></p>
<p>​    假设从$n_{k+1}$到$n_m$已经被翻转，现在你处在$n_k$。<code>n1-&gt;...-&gt;nk-1-&gt;nk-&gt;nk+1&lt;-...&lt;-nm</code></p>
<p>​    我们打算$n_{k+1}$的next指针指向$n_k$，所以:<code>nk.next.next=nk;</code></p>
<p>​    小心$n_1$的next指针必须要指向∅，如果你忘记了，那么链表中会成一个环。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> ListNode <span class="title">reverseList</span><span class="params">(ListNode head)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) <span class="keyword">return</span> head;</div><div class="line">    ListNode p = reverseList(head.next);</div><div class="line">    head.next.next = head;</div><div class="line">    head.next = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">return</span> p;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="复杂度分析-1"><a href="#复杂度分析-1" class="headerlink" title="复杂度分析"></a>复杂度分析</h4><ul>
<li>时间复杂度：$O(n)$</li>
<li>空间复杂度：$O(n)$</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          
    
        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Zhuo Jimmy" />
          <p class="site-author-name" itemprop="name">Zhuo Jimmy</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">37</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2116491901" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="mailto:zhuo_jimmy@yeah.net" target="_blank" title="email">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                  email
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhuo Jimmy</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	




  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  



  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


</body>
</html>
